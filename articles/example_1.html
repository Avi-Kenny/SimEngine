<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="SimEngine">
<title>Example 1: Simulation-based power calculation • SimEngine</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Example 1: Simulation-based power calculation">
<meta property="og:description" content="SimEngine">
<meta property="og:image" content="https://avi-kenny.github.io/SimEngine/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SimEngine</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/SimEngine.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/advanced-usage.html">Advanced usage</a>
    <a class="dropdown-item" href="../articles/example_1.html">Example 1: Simulation-based power calculation</a>
    <a class="dropdown-item" href="../articles/example_2.html">Example 2: Comparing two standard error estimators</a>
    <a class="dropdown-item" href="../articles/parallelization.html">Parallelization</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Avi-Kenny/SimEngine/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Example 1: Simulation-based power calculation</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Avi-Kenny/SimEngine/blob/HEAD/vignettes/example_1.Rmd" class="external-link"><code>vignettes/example_1.Rmd</code></a></small>
      <div class="d-none name"><code>example_1.Rmd</code></div>
    </div>

    
    
<p>Calculating statistical power is a critical step in the design of
experiments. For a given study design, the statistical power is defined
as the probability that a hypothesis test correctly rejects the null
hypothesis (assuming it is false). Sometimes, the sample size for a
study is considered fixed, and interest lies in calculating power. More
often, investigators want to know what sample size is needed to reject
the null hypothesis at a given power level (e.g. 80% or 90%). We assume
that the reader has some familiarity with statistical hypothesis
testing.</p>
<p>For simple study designs (e.g. an individually randomized controlled
trial with two groups), formulas exist to calculate the sample size
necessary to reject the null hypothesis under certain assumptions around
the distribution of your outcome, the effect size, etc. For example, in
an experiment comparing means between two groups, the following formula
is used to calculate the necessary sample size to reject a null
hypothesis with power <span class="math inline">\(1-\beta\)</span> and
type I error rate <span class="math inline">\(\alpha\)</span>, where the
outcome variable has means <span class="math inline">\(\mu_0,\mu_1\)</span> and standard deviations <span class="math inline">\(\sigma_0^2,\sigma_1^2\)</span> in the two groups
and <span class="math inline">\(z_{\alpha/2}\)</span> and <span class="math inline">\(z_\beta\)</span> represent quantiles of the
standard normal distribution:</p>
<p><span class="math display">\[n =
\frac{(z_{\alpha/2}+z_\beta)^2(\sigma_0^2+\sigma_1^2)}{(\mu_0-\mu_1)^2}\]</span></p>
<p>However, for more complex study designs or analysis plans, formulas
may not exist or may be very difficult to adapt to a particular setting.
In these situations, an easier approach is to conduct simulation-based
power calculations. The basic idea is that you repeatedly simulate your
entire experiment and calculate the proportion of experiments in which
the null hypothesis is rejected; this is your estimated power.
Simulating your entire experiment will typically involve generating a
dataset, and then running an analysis that involves a hypothesis test.
Randomness is usually introduced into the process through the dataset
generation, although sometimes you will fix a population dataset and
induce randomization by taking samples from that population (e.g. to
simulate survey data analyses). Often, the most difficult part is to
simulate a dataset that accurately reflects the nuances (e.g. the
correlation structure) of your real dataset.</p>
<p>If you want to calculate sample size at a fixed power level
(e.g. 90%), you can use a “guess and check” approach. With this
approach, you select a sample size <span class="math inline">\(n_1\)</span> and run the simulation to estimate
your power. If power is estimated to be lower than 90%, you select a new
value <span class="math inline">\(n_2\)</span> that is larger than <span class="math inline">\(n_1\)</span> and run the simulation again. You
repeat this procedure until the estimated power is roughly 90%.</p>
<p>We illustrate this process by simulating a randomized controlled
trial and comparing our results to what we get from the formula above.
We then show how our simulation can be modified to adapt to more complex
scenarios.</p>
<p>First, we declare a new simulation object and write a function to
generate data:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_sim.html">new_sim</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">create_rct_data</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">mu_0</span>, <span class="va">mu_1</span>, <span class="va">sigma_0</span>, <span class="va">sigma_1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,<span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">outcome</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">group</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="va">n</span>, mean<span class="op">=</span><span class="va">mu_0</span>, sd<span class="op">=</span><span class="va">sigma_0</span><span class="op">)</span> <span class="op">+</span></span>
<span>             <span class="va">group</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="va">n</span>, mean<span class="op">=</span><span class="va">mu_1</span>, sd<span class="op">=</span><span class="va">sigma_1</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"group"</span><span class="op">=</span><span class="va">group</span>, <span class="st">"outcome"</span><span class="op">=</span><span class="va">outcome</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Test our data-generating function</span></span>
<span><span class="fu">create_rct_data</span><span class="op">(</span>n<span class="op">=</span><span class="fl">3</span>, mu_0<span class="op">=</span><span class="fl">3</span>, mu_1<span class="op">=</span><span class="fl">4</span>, sigma_0<span class="op">=</span><span class="fl">0.1</span>, sigma_1<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="co">#&gt;   group  outcome</span></span>
<span><span class="co">#&gt; 1     1 4.078642</span></span>
<span><span class="co">#&gt; 2     0 2.991081</span></span>
<span><span class="co">#&gt; 3     0 2.889373</span></span>
<span><span class="co">#&gt; 4     1 4.078642</span></span>
<span><span class="co">#&gt; 5     0 2.991081</span></span>
<span><span class="co">#&gt; 6     1 3.784518</span></span></code></pre></div>
<p>Next, we add a function that takes a dataset generated by our
function and runs a statistical test to decide whether to reject the
null hypothesis:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">run_test</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">test_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">outcome</span><span class="op">~</span><span class="va">group</span>, data<span class="op">=</span><span class="va">data</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">test_result</span><span class="op">$</span><span class="va">p.value</span><span class="op">&lt;</span><span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Next, we write the simulation script and tell SimEngine to run 1,000
simulation replicates each for four sample sizes.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> <span class="fu"><a href="../reference/set_script.html">set_script</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">create_rct_data</span><span class="op">(</span>n<span class="op">=</span><span class="va">L</span><span class="op">$</span><span class="va">n</span>, mu_0<span class="op">=</span><span class="fl">17</span>, mu_1<span class="op">=</span><span class="fl">18</span>, sigma_0<span class="op">=</span><span class="fl">2</span>, sigma_1<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">reject</span> <span class="op">&lt;-</span> <span class="fu">run_test</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"reject"</span><span class="op">=</span><span class="va">reject</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> <span class="fu"><a href="../reference/set_levels.html">set_levels</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">40</span>,<span class="fl">60</span>,<span class="fl">80</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sim</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> <span class="fu"><a href="../reference/set_config.html">set_config</a></span><span class="op">(</span>num_sim<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p>We are now ready to run the simulation. After obtaining results, we
calculate power by averaging the ‘reject’ variable using the
<code>summarize</code> function, which tells us the percentage of
simulations in which the null hypothesis was rejected.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/compound.html" class="external-link">%&lt;&gt;%</a></span> <span class="fu"><a href="../reference/run.html">run</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Done. No errors or warnings detected.</span></span>
<span></span>
<span><span class="va">power_sim</span> <span class="op">&lt;-</span> <span class="va">sim</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/summarize.html">summarize</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"mean"</span>, name<span class="op">=</span><span class="st">"power"</span>, x<span class="op">=</span><span class="st">"reject"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">power_sim</span><span class="op">)</span></span>
<span><span class="co">#&gt;   level_id  n n_reps power</span></span>
<span><span class="co">#&gt; 1        1 20   1000 0.381</span></span>
<span><span class="co">#&gt; 2        2 40   1000 0.586</span></span>
<span><span class="co">#&gt; 3        3 60   1000 0.737</span></span>
<span><span class="co">#&gt; 4        4 80   1000 0.849</span></span></code></pre></div>
<p>We can compare our results to what we obtain by using the formula
stated earlier.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">power_formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">40</span>,<span class="fl">60</span>,<span class="fl">80</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="op">(</span><span class="fl">17</span><span class="op">-</span><span class="fl">18</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="fl">2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">0.025</span>, lower.tail<span class="op">=</span><span class="cn">F</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">40</span>,<span class="fl">60</span>,<span class="fl">80</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  power <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">power_sim</span><span class="op">$</span><span class="va">power</span>, <span class="va">power_formula</span><span class="op">)</span>,</span>
<span>  which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Simulation"</span>,<span class="st">"Formula"</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">n</span>, y<span class="op">=</span><span class="va">power</span>, color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">which</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"Method"</span>, y<span class="op">=</span><span class="st">"Power"</span>, x<span class="op">=</span><span class="st">"Sample size (per group)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_1_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
<p>Of course, real applications will typically involve much more complex
data generating mechanisms and analyses, but the same basic principles
illustrated in the code above will always apply to simulation-based
power calculations.</p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Avi Kenny, Charles Wolock.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
